<!doctype html>
<html lang="en">
<%- include('../partials/head', {title: "Unbiased - Feed"}) %>

<body>
    <%- include('../partials/nav', {user: locals.user, karma}) %>
    <%- include('../partials/jumbotron', {name: "Feed"}) %>
    <span id="auth"><%= isAuth %></span>

    <div class="container">
        <div class="row">
            <div class="main col-md-8">
                <%- include('../partials/sort') %>


                <% if (posts != undefined) { 
                    posts.forEach((post) => { %>
                <article class="post" data-ref="<%= post._id %>">

                    <div class="arrows col-md-12 d-flex flex-column justify-content-between ">

                        <div class="vote-count col-md-12 d-flex justify-content-between">
                            <% if(post.type == "img") { %>
                            <a href="<%= post.link %>"><img src="<%=post.link%>" height="55" width="55"
                                    class="thumbnail"></a>
                            <% } else if (post.type == "link") { %>
                            <kbd class="p-4  d-inline thumbnail" style="font-weight: 900">
                                <div style="font-size:2rem;"><%= post.username.charAt(0).toUpperCase()%></div>
                            </kbd>
                            <% } else { %>
                            <a href="/r/<%= post.subreddit %>/<%= post._id %>"><img src="/images/post.png" height="55"
                                    width="55" class="thumbnail"></a>
                            <% } %>
                            <div class="downvote-post auth-req d-flex flex-column">
                                <h6>Swing Left</h6>
                                <i class="far fa-2x fa-caret-square-left text-center"></i>
                                <span class="downpost-votes text-center"
                                    data-ref="<%= post._id %>"><%= post.downvotes %></span>
                            </div>
                            <div class="neutralvote-post auth-req d-flex flex-column">
                                <h6>Neutral</h6>
                                <i class="far fa-2x fa-caret-square-up text-center"></i>
                                <span class="neutralpost-votes text-center"
                                    data-ref="<%= post._id %>"><%= post.neutralvotes %></span>
                            </div>

                            <div class="upvote-post auth-req d-flex flex-column">
                                <h6>Swing Right</h6>
                                <i class="far fa-2x fa-caret-square-right text-center"></i>
                                <span class="upvote-post-votes text-center"
                                    data-ref="<%= post._id %>"><%= post.upvotes %></span>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex col-md-12 justify-content-around">
                        <div class="col-md-9 col ml-3 text-truncate text-center">
                            <% if(post.type == "post") { %>
                            <a style="text-transform:capitalize"
                                href="/r/<%= post.subreddit %>/<%= post._id %>"><%= post.title %></a>
                            <%  } else { %>
                            <a href="<%= post.link %>" target="_blank"><%= post.link %></a>
                            <% } %>
                        </div>
                        <!-- Submitted <time title="<%= post.time %>">-</time>
                            By <span class="post-user"><a style="text-transform:capitalize"
                                    href="/u/<%= post.username %>"><%= post.username %></a></span> -->
                        <!-- from <span><a href="/r/<%= post.subreddit %>">/r/<%= post.subreddit %></a></span> -->
                        <% if(post.username == locals.user) { %>
                        <div class="col col-md-3">
                            <ul class="post-options">
                                <!-- <li><a href="/r/<%=post.subreddit %>/<%= post._id %>"><%=post.num_of_comments%>
                                        comments</a>
                                </li> -->
                                <!-- <li><a href="javascript:void(0)" class="save-post auth-req">Save</a></li> -->
                                <li><a href="javascript:void(0)" class="delete-post auth-req">Delete</a>
                                </li>
                            </ul>
                        </div>
                        <% } %>
                    </div>
                </article>
                <% });%>
                <% } else { %>
                There are no posts.
                <% } %>
            </div>

            <div class="sidebar col-md-4 order-first order-md-last">
                <%- include('../partials/sidebar_index_actions') %>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/autosize@4.0.2/dist/autosize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>

    <script src="/js/load.js"></script>
    <script src="/js/index.js"></script>
    <script src="/js/post.js"></script>
    <script src="/js/sort.js"></script>

</body>

</html>